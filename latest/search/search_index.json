{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Overview","text":"ustraj <p>A collection of scripts for analysing trajectory files collected during US simulations</p> <p> </p> <p>The <code>ustraj</code> framework ...</p>"},{"location":"#installation","title":"Installation","text":"<p>This package can be installed using <code>conda</code> (or <code>mamba</code>, a faster version of <code>conda</code>):</p> <pre><code>mamba install -c conda-forge ustraj\n</code></pre>"},{"location":"#getting-started","title":"Getting Started","text":"<p>To get started, see the documentation.</p>"},{"location":"development/","title":"Development","text":"<p>To create a development environment, you must have <code>mamba</code> installed.</p> <p>A development conda environment can be created and activated with:</p> <pre><code>make env\nconda activate ustraj\n</code></pre> <p>To format the codebase:</p> <pre><code>make format\n</code></pre> <p>To run the unit tests:</p> <pre><code>make test\n</code></pre> <p>To serve the documentation locally:</p> <pre><code>mkdocs serve\n</code></pre>"},{"location":"reference/","title":"Index","text":""},{"location":"reference/#ustraj","title":"ustraj","text":"<p>A collection of scripts for analysing trajectory files collected during US simulations</p> <p>Modules:</p> <ul> <li> <code>analysis</code>           \u2013            <p>Functions to analyse US trajectory files</p> </li> </ul>"},{"location":"reference/SUMMARY/","title":"SUMMARY","text":"<ul> <li>ustraj<ul> <li>analysis</li> </ul> </li> </ul>"},{"location":"reference/analysis/","title":"analysis","text":""},{"location":"reference/analysis/#ustraj.analysis","title":"analysis","text":"<p>Functions to analyse US trajectory files</p> <p>Functions:</p> <ul> <li> <code>count_hbonds</code>             \u2013              <p>Calculate the number of hydrogen bonds formed to a specific residue during</p> </li> <li> <code>calc_solvent_rdf</code>             \u2013              <p>Calculate the solvent RDF around an atom of interest</p> </li> </ul>"},{"location":"reference/analysis/#ustraj.analysis.count_hbonds","title":"count_hbonds","text":"<pre><code>count_hbonds(\n    residue_index,\n    prmtop_filepath,\n    free_energy_step,\n    restraint_type,\n    dof,\n    run_number,\n    CV0,\n    sidechain_only=True,\n    step=10,\n    solvent_only=False,\n)\n</code></pre> <p>Calculate the number of hydrogen bonds formed to a specific residue during the course of a certain trajectory file.</p>"},{"location":"reference/analysis/#ustraj.analysis.count_hbonds--parameters","title":"Parameters","text":"<p>residue_index : int     Residue of interest for hydrogen bonding analysis</p> str <p>The filepath for the topology file corresponding to the desired trajectory</p> str <p>The desired type of US simulation. The options are 'separation', 'RMSD' or 'Boresch'.</p> str <p>The type of RMSD restraints used. The options are 'CA' or 'backbone'.</p> str <p>The degree of freedom. For free_energy_step='Boresch', the options are 'thetaA', 'thetaB', 'phiA', 'phiB', 'phiC'. For free_energy_step='RMSD', the options specify bound or bulk state, as well as the restrain order.</p> int <p>The desired replicate</p> bool, optional, default=True <p>Only use the sidechain of the residue</p> int, optional, default=10 <p>Step to use when analysing the frames, makes analysis quicker</p> bool, optional, default=False <p>Only consider H-bonding to solvent</p>"},{"location":"reference/analysis/#ustraj.analysis.count_hbonds--returns","title":"Returns","text":"<p>donor_data: dict     Dictionary containing information about the residue of interest being     involved as a hydrogen bond donor.</p> dict <p>Dictionary containing information about the residue of interest being involved as a hydrogen bond acceptor.</p> Source code in <code>ustraj/analysis.py</code> <pre><code>def count_hbonds(\n    residue_index,\n    prmtop_filepath,\n    free_energy_step,\n    restraint_type,\n    dof,\n    run_number,\n    CV0,\n    sidechain_only=True,\n    step=10,\n    solvent_only=False,\n):\n    \"\"\"\n    Calculate the number of hydrogen bonds formed to a specific residue during\n    the course of a certain trajectory file.\n\n    Parameters\n    ----------\n    residue_index : int\n        Residue of interest for hydrogen bonding analysis\n\n    prmtop_filepath : str\n        The filepath for the topology file corresponding to the desired trajectory\n\n    free_energy_step : str\n        The desired type of US simulation. The options are 'separation',\n        'RMSD' or 'Boresch'.\n\n    restraint_type : str\n        The type of RMSD restraints used. The options are 'CA' or 'backbone'.\n\n    dof : str\n        The degree of freedom. For free_energy_step='Boresch', the options are\n        'thetaA', 'thetaB', 'phiA', 'phiB', 'phiC'. For free_energy_step='RMSD',\n        the options specify bound or bulk state, as well as the restrain order.\n\n    run_number : int\n        The desired replicate\n\n    sidechain_only : bool, optional, default=True\n        Only use the sidechain of the residue\n\n    step : int, optional, default=10\n        Step to use when analysing the frames, makes analysis quicker\n\n    solvent_only: bool, optional, default=False\n        Only consider H-bonding to solvent\n\n    Returns\n    -------\n    donor_data: dict\n        Dictionary containing information about the residue of interest being\n        involved as a hydrogen bond donor.\n\n    acceptor_data: dict\n        Dictionary containing information about the residue of interest being\n        involved as a hydrogen bond acceptor.\n\n    \"\"\"\n    dcd_filepath = _get_filepath(free_energy_step, restraint_type, dof, run_number, CV0)\n\n    # Check provided topology file exists\n    if not _os.path.exists(prmtop_filepath):\n        raise FileNotFoundError(f\"No topology file found at '{prmtop_filepath}'!\")\n\n    u = _mda.Universe(prmtop_filepath, dcd_filepath)\n\n    water_sel = \"resname WAT\"\n    res_id = f\"resid {residue_index}\"\n\n    # residue atoms to consider (sidechain vs whole residue)\n    res_sel = f\"({res_id}) and not backbone\" if sidechain_only else f\"({res_id})\"\n\n    partner_sel = (\n        f\"not ({res_id})\"  # exclude the whole residue regardless of sidechain_only\n    )\n\n    # Residue acting as donor\n    hydrogens0 = f\"({res_sel}) and name H*\"\n    acceptors0 = f\"({partner_sel}) and (name O* or name N* or name S*)\"\n\n    # Residue acting as acceptor\n    hydrogens1 = f\"({partner_sel}) and name H*\"\n    acceptors1 = f\"({res_sel}) and (name O* or name N* or name S*)\"\n\n    if solvent_only:\n        acceptors0 += f\" and ({water_sel})\"\n        hydrogens1 += f\" and ({water_sel})\"\n\n    # Identify possible donor interactions\n    h0 = _HBA(\n        u,\n        hydrogens_sel=hydrogens0,\n        acceptors_sel=acceptors0,\n    )\n    h0.run(start=0, stop=None, step=step, verbose=True)\n\n    # Identify possible acceptor interactions\n    h1 = _HBA(\n        u,\n        hydrogens_sel=hydrogens1,\n        acceptors_sel=acceptors1,\n    )\n    h1.run(start=0, stop=None, step=step, verbose=True)\n\n    # Find simulation time\n    t_final = _np.round(u.trajectory[-1].time / 1000, 4)\n    time = _np.linspace(0, t_final, len(h0.count_by_time()))\n\n    donor_data = {\n        \"Time (ns)\": time,\n        \"Count by time\": h0.count_by_time(),\n        \"Count by ID\": h0.count_by_ids(),\n        \"Count by type\": h0.count_by_type(),\n    }\n\n    acceptor_data = {\n        \"Time (ns)\": time,\n        \"Count by time\": h1.count_by_time(),\n        \"Count by ID\": h1.count_by_ids(),\n        \"Count by type\": h1.count_by_type(),\n    }\n\n    return donor_data, acceptor_data\n</code></pre>"},{"location":"reference/analysis/#ustraj.analysis.calc_solvent_rdf","title":"calc_solvent_rdf","text":"<pre><code>calc_solvent_rdf(\n    atom_index,\n    prmtop_filepath,\n    free_energy_step,\n    restraint_type,\n    dof,\n    run_number,\n    CV0,\n    step=10,\n)\n</code></pre> <p>Calculate the solvent RDF around an atom of interest</p>"},{"location":"reference/analysis/#ustraj.analysis.calc_solvent_rdf--parameters","title":"Parameters","text":"<p>atom_index : int     Atom used to compute the RDF</p> str <p>The filepath for the topology file corresponding to the desired trajectory</p> str <p>The desired type of US simulation. The options are 'separation', 'RMSD' or 'Boresch'.</p> str <p>The type of RMSD restraints used. The options are 'CA' or 'backbone'.</p> str <p>The degree of freedom. For free_energy_step='Boresch', the options are 'thetaA', 'thetaB', 'phiA', 'phiB', 'phiC'. For free_energy_step='RMSD', the options specify bound or bulk state, as well as the restrain order.</p> int <p>The desired replicate</p> int, optional, default=10 <p>Step to use when analysing the frames, makes analysis quicker</p>"},{"location":"reference/analysis/#ustraj.analysis.calc_solvent_rdf--returns","title":"Returns","text":"<p>distance : np.ndarray     Radial separation distance in Angstroms</p> np.ndarray <p>Normalised RDF around the specified atom</p> Source code in <code>ustraj/analysis.py</code> <pre><code>def calc_solvent_rdf(\n    atom_index,\n    prmtop_filepath,\n    free_energy_step,\n    restraint_type,\n    dof,\n    run_number,\n    CV0,\n    step=10,\n):\n    \"\"\"\n    Calculate the solvent RDF around an atom of interest\n\n    Parameters\n    ----------\n    atom_index : int\n        Atom used to compute the RDF\n\n    prmtop_filepath : str\n        The filepath for the topology file corresponding to the desired trajectory\n\n    free_energy_step : str\n        The desired type of US simulation. The options are 'separation',\n        'RMSD' or 'Boresch'.\n\n    restraint_type : str\n        The type of RMSD restraints used. The options are 'CA' or 'backbone'.\n\n    dof : str\n        The degree of freedom. For free_energy_step='Boresch', the options are\n        'thetaA', 'thetaB', 'phiA', 'phiB', 'phiC'. For free_energy_step='RMSD',\n        the options specify bound or bulk state, as well as the restrain order.\n\n    run_number : int\n        The desired replicate\n\n    step : int, optional, default=10\n        Step to use when analysing the frames, makes analysis quicker\n\n    Returns\n    -------\n    distance : np.ndarray\n        Radial separation distance in Angstroms\n\n    rdf: np.ndarray\n        Normalised RDF around the specified atom\n\n    \"\"\"\n    dcd_filepath = _get_filepath(free_energy_step, restraint_type, dof, run_number, CV0)\n\n    # Check provided topology file exists\n    if not _os.path.exists(prmtop_filepath):\n        raise FileNotFoundError(f\"No topology file found at '{prmtop_filepath}'!\")\n\n    u = _mda.Universe(prmtop_filepath, dcd_filepath)\n\n    selected_atom = u.select_atoms(f\"index {atom_index}\")\n    solvent = u.select_atoms(\"resname WAT\")\n\n    rdf = _InterRDF(selected_atom, solvent)\n    rdf.run(step=step, verbose=True)\n\n    return rdf.bins, rdf.rdf\n</code></pre>"}]}